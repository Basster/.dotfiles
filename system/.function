#!/bin/bash

function proxyon {
	export http_proxy=http://http-proxy.intern.neusta.de:3128
	export https_proxy=http://https-proxy.intern.neusta.de:3128
	export ftp_proxy=http://ftp-proxy.intern.neusta.de:3128
	export HTTP_PROXY=$http_proxy
	export HTTPS_PROXY=$https_proxy
	export FTP_PROXY=$ftp_proxy
	export no_proxy=.vm,.dev,neusta.de,localhost,127.0.0.1,172.32.
	export HTTP_PROXY_REQUEST_FULLURI=true
	export HTTPS_PROXY_REQUEST_FULLURI=true

	echo "System proxy activated"
}

function proxyoff {
	unset http_proxy
	unset https_proxy
	unset ftp_proxy
	unset HTTP_PROXY
	unset HTTPS_PROXY
	unset FTP_PROXY
	unset no_proxy
	unset HTTP_PROXY_REQUEST_FULLURI
	unset HTTPS_PROXY_REQUEST_FULLURI

	echo "System proxy deactivated"
}

function docker-pxon {
	sudo ln -s /opt/docker-config/http-proxy.conf /etc/systemd/system/docker.service.d/http-proxy.conf
	sudo systemctl daemon-reload
	sudo systemctl restart docker

	echo "Docker proxy activated"
}

function docker-pxof {
	sudo rm -f /etc/systemd/system/docker.service.d/http-proxy.conf
	sudo systemctl daemon-reload
	sudo systemctl restart docker

	echo "Docker proxy deactivated"
}

function pxon {

	pxof

	proxyon
	
	git config --global http.proxy http://http-proxy.intern.neusta.de:3128
	git config --global https.proxy http://https-proxy.intern.neusta.de:3128

	echo "Git proxy activated"

	npm config set proxy http://http-proxy.intern.neusta.de:3128
	npm config set https-proxy http://https-proxy.intern.neusta.de:3128

	echo "NPM proxy activated"
}

function pxof {

	proxyoff
	
	git config --global --unset http.proxy
	git config --global --unset https.proxy

	echo "Git proxy deactivated"

	npm config delete proxy
	npm config delete https-proxy

	echo "NPM proxy deactivated"
}

function perf {
  curl -o /dev/null -s -w "%{time_connect} + %{time_starttransfer} = %{time_total}\n" "$1"
}